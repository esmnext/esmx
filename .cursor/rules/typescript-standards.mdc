
---
globs: "*.ts,*.tsx,*.vue"
description: "TypeScriptç¼–ç æ ‡å‡†å’Œç±»åž‹å®‰å…¨è§„èŒƒ"
---

# ðŸ’» TypeScript ç¼–ç æ ‡å‡†

## âœ… ESM æ¨¡å—ç³»ç»Ÿè¦æ±‚
- **å¼ºåˆ¶ä½¿ç”¨ ESM (ECMAScript Modules) è¿›è¡Œå¼€å‘**
- **ä½¿ç”¨ `import/export` è¯­å¥ï¼Œç¦ç”¨ `require/module.exports`**
- **Node.js å†…ç½®æ¨¡å—å¿…é¡»ä½¿ç”¨ `node:` å‰ç¼€**
- **é…ç½® `"type": "module"` åœ¨ package.json ä¸­**

## ðŸ—ï¸ Monorepo å¼€å‘è§„èŒƒ
- **ä½¿ç”¨ `pnpm workspace` ç®¡ç† monorepo ä¾èµ–**
- **åŒ…é—´å¼•ç”¨ä½¿ç”¨ workspace åè®®ï¼š`"workspace:*"`**
- **åŒ…åéµå¾ªå‘½åç©ºé—´ï¼š`@project/package-name`**
- **å…±äº«é…ç½®æ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•**
- **åŒ…çº§åˆ«çš„é…ç½®ç»§æ‰¿æ ¹é…ç½®**
- **examples** ç›®å½•åŒ…å«ç¤ºä¾‹é¡¹ç›®ï¼Œæ”¯æŒåµŒå¥—ç»“æž„
- **æž„å»ºäº§ç‰© (`dist/`) è‡ªåŠ¨æŽ’é™¤åœ¨ workspace å¤–**

**ç›®å½•ç»“æž„**ï¼š
```
project/
â”œâ”€â”€ packages/           # æ ¸å¿ƒåŒ…ç›®å½•
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ src/
â”‚   â””â”€â”€ ui/
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ src/
â”œâ”€â”€ examples/           # ç¤ºä¾‹é¡¹ç›®ç›®å½•
â”‚   â”œâ”€â”€ basic-app/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ src/
â”‚   â””â”€â”€ advanced-demo/
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ src/
â”œâ”€â”€ package.json (workspace root)
â”œâ”€â”€ pnpm-workspace.yaml
â””â”€â”€ tsconfig.json (base config)
```

**pnpm-workspace.yaml é…ç½®**ï¼š
```yaml
packages:
  - 'packages/*'      # æ ¸å¿ƒåŒ…
  - 'examples/**'     # ç¤ºä¾‹é¡¹ç›®ï¼ˆæ”¯æŒåµŒå¥—ï¼‰
  - '!**/dist/**'     # æŽ’é™¤æž„å»ºäº§ç‰©
```

**åŒ…é—´ä¾èµ–**ï¼š
```json
{
  "dependencies": {
    "@project/core": "workspace:*",
    "@project/utils": "workspace:*"
  }
}
```

**å¯¼å…¥è§„èŒƒ**ï¼š
```typescript
// âœ… Core package imports
import { createUser } from '@project/core';
import { logger } from '@project/utils';

// âœ… Example project imports (examples directory)
import { DemoComponent } from '@project/demo-components';
import { exampleConfig } from '@project/example-config';

// âœ… Internal module imports
import { validateEmail } from '../validators';
import { formatDate } from './utils';
```

## ðŸ›¡ï¸ ç±»åž‹å®‰å…¨è¦æ±‚
- **æ‰€æœ‰ä»£ç ä½¿ç”¨ TypeScriptï¼Œä¼˜å…ˆä½¿ç”¨ interfaces è€Œéž types**
- **âŒ é¿å… enumsï¼Œä½¿ç”¨ const å¯¹è±¡ä»£æ›¿**
- **å¯ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼ä»¥æé«˜ç±»åž‹å®‰å…¨**
- **âŒ é¿å… `any` ç±»åž‹ï¼Œç±»åž‹ä¸ç¡®å®šæ—¶ä½¿ç”¨ `unknown`**

## ðŸ“ ä»£ç ç¤ºä¾‹

### âœ… æŽ¨èå†™æ³•
```typescript
interface UserData {
  id: string;
  email: string;
  isActive: boolean;
}

const PAYMENT_STATUS = {
  PENDING: 'pending',
  COMPLETED: 'completed',
  FAILED: 'failed'
} as const;

// Use unknown instead of any
const processInput = (input: unknown): UserData => {
  if (typeof input === 'object' && input !== null) {
    return input as UserData;
  }
  throw new Error('Invalid input');
};
```

### âŒ é¿å…å†™æ³•
```typescript
enum PaymentStatus {
  PENDING = 'pending',
  COMPLETED = 'completed', 
  FAILED = 'failed'
}

// Avoid using any
const processInput = (input: any): UserData => {
  return input;
};
```

## ðŸ“¦ å¯¼å…¥è§„èŒƒ
**ä¸¥æ ¼æŒ‰ç…§ Biome é»˜è®¤å¯¼å…¥é¡ºåºè§„èŒƒï¼š**
1. **Bun å¯¼å…¥**ï¼š`bun:*` æ¨¡å—
2. **Node.js å†…ç½®æ¨¡å—**ï¼š`node:*` å‰ç¼€çš„æ¨¡å—
3. **å¤–éƒ¨åº“**ï¼šæ¥è‡ª node_modules çš„ç¬¬ä¸‰æ–¹åŒ…
4. **Monorepo åŒ…é—´å¯¼å…¥**ï¼š`@project/*` å‘½åç©ºé—´çš„åŒ…
5. **å†…éƒ¨æ¨¡å—ï¼ˆç»å¯¹è·¯å¾„ï¼‰**ï¼šå½“å‰åŒ…å†…çš„ç»å¯¹å¯¼å…¥
6. **ç›¸å¯¹å¯¼å…¥ï¼ˆçˆ¶çº§ï¼‰**ï¼š`../` å¼€å¤´çš„å¯¼å…¥
7. **ç›¸å¯¹å¯¼å…¥ï¼ˆåŒçº§ï¼‰**ï¼š`./` å¼€å¤´çš„å¯¼å…¥
8. **ç±»åž‹å¯¼å…¥**ï¼š`import type` è¯­å¥ï¼ˆæ¯ä¸ªç»„å†…åˆ†åˆ«æŽ’åˆ—ï¼‰

**é‡è¦è¦æ±‚**ï¼š
- **ä¸åŒå¯¼å…¥ç»„ä¹‹é—´å¿…é¡»ç”¨ç©ºè¡Œåˆ†éš”**
- **åŒç»„å†…å¯¼å…¥æŒ‰å­—æ¯é¡ºåºæŽ’åˆ—**
- **ç±»åž‹å¯¼å…¥æ”¾åœ¨å¯¹åº”ç»„çš„æœ€åŽ**
- **âŒ Bun å’Œ Node.js å†…ç½®æ¨¡å—ä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥ï¼Œç¦æ­¢å…·åå¯¼å…¥**

```typescript
// âœ… Compliant with Biome import order specification
import fs from 'node:fs/promises';
import path from 'node:path';
import util from 'node:util';

import express from 'express';
import { z } from 'zod';

import { createUser } from '@project/core';
import { logger } from '@project/utils';

import { config } from '@/config';
import { database } from '@/lib/database';

import { validateRequest } from '../middleware';
import { userSchema } from '../schemas';

import { formatDate } from './utils';
import { constants } from './constants';

import type { Request, Response } from 'express';
import type { UserData } from '@project/core';
import type { Config } from './types';

// âŒ Forbidden import patterns
import { readFile } from 'node:fs/promises'; // Forbidden: named imports
import { join } from 'node:path';            // Forbidden: named imports
const fs = require('fs');                    // Forbidden: CommonJS
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```typescript
// âœ… Correct usage
import fs from 'node:fs/promises';
import path from 'node:path';

const content = await fs.readFile('file.txt', 'utf-8');
const fullPath = path.join(process.cwd(), 'src', 'index.ts');

// âŒ Incorrect usage
import { readFile } from 'node:fs/promises';
import { join } from 'node:path';
```

## ðŸš€ å¯¼å‡ºè§„èŒƒ
- **ä¼˜å…ˆä½¿ç”¨å‘½åå¯¼å‡º**
- **åªåœ¨ç»å¯¹å¿…è¦æ—¶ä½¿ç”¨é»˜è®¤å¯¼å‡º**
- **ä½¿ç”¨ ESM å¯¼å‡ºè¯­æ³•**

```typescript
// âœ… Recommended ESM exports
export const createUser = (data: UserData): User => { /* */ };
export const updateUser = (id: string, data: Partial<UserData>): User => { /* */ };
export { validateEmail, formatDate } from './utils';

// âŒ Forbidden CommonJS exports
module.exports = { createUser, updateUser };
exports.createUser = (data) => { /* */ };
```
